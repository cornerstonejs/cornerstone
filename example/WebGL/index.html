    <!DOCTYPE HTML>
<html>
<head>
    <!-- twitter bootstrap CSS stylesheet - not required by cornerstone -->
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container">

<h1>
WebGL Example
</h1>

This is a work-in-progress example of WebGL use in cornerstone

<br>
<br>

<div class="row">
    <div class="col-xs-6">
        <h4>WebGL</h4>
        <div style="width:512px;height:512px;position:relative;color: white;"
             class="cornerstone-enabled-image"
             oncontextmenu="return false"
             unselectable='on'
             onselectstart='return false;'
             onmousedown='return false;'>
            <div id="dicomImageWebGL" oncontextmenu="return false"
                 style="width:512px;height:512px;top:0px;left:0px; position:absolute">
            </div>
            <div class="topleft" style="position: absolute;top:0px; left:0px">
                Patient Name
            </div>
            <div class="topright" style="position: absolute;top:0px; right:0px">
                Render Time:
            </div>
            <div class="bottomright" style="position: absolute;bottom:0px; right:0px">
                Zoom:
            </div>
            <div class="bottomleft" style="position: absolute;bottom:0px; left:0px">
                WW/WC:
            </div>

        </div>
    </div>
    <div class="col-xs-6">
        <h4>Canvas</h4>
        <div style="width:512px;height:512px;position:relative;color: white;"
             class="cornerstone-enabled-image"
             oncontextmenu="return false"
             unselectable='on'
             onselectstart='return false;'
             onmousedown='return false;'>
            <div id="dicomImage" oncontextmenu="return false"
                 style="width:512px;height:512px;top:0px;left:0px; position:absolute">
            </div>
            <div class="topleft" style="position: absolute;top:0px; left:0px">
                Patient Name
            </div>
            <div class="topright" style="position: absolute;top:0px; right:0px">
                Render Time:
            </div>
            <div class="bottomright" style="position: absolute;bottom:0px; right:0px">
                Zoom:
            </div>
            <div class="bottomleft" style="position: absolute;bottom:0px; left:0px">
                WW/WC:
            </div>

        </div>
    </div>
</div>

</div>
</body>

<!-- cornerstone depends on jQuery so it must be loaded first-->
<script src="../jquery.min.js"></script>

<!-- include the cornerstone library -->
<script src="../../dist/cornerstone.js"></script>

<!-- include special code for these examples which provides images -->
<script src="../dicomParser.js"></script>
<script src="../cornerstoneWADOImageLoader.js"></script>
<script src="../cornerstoneWebImageLoader.js"></script>

<script src="../cornerstoneMath.min.js"></script>
<script src="../cornerstoneTools.js"></script>
<script src="../hammer.min.js"></script>
<script src="../jpx.min.js"></script>

<script src="../exampleImageIdLoader.js"></script>
<script src="../cornerstoneTestImageLoader.js"></script>

<script>

    $(document).ready(function() {
        // UInt16 Image generated via CornerstoneTestImageLoader
        var rampImageId = "ramp://"+256+","+256 +"," + 16;
        //var imageId = rampImageId;

        // CR
        var imageId = 'dicomweb:http://cornerstonetech.org/images/ClearCanvas/CRStudy/1.3.51.5145.5142.20010109.1105627.1.0.1.dcm';
        //var imageId = 'dicomweb:http://jpx.jfpb.net/data/raw.dcm';
        //var imageId= 'dicomweb:http://cornerstonetech.org/images/ClearCanvas/DXStudy/1.2.840.113619.2.67.2158294438.16324010109084338.243.dcm';
        
        // Uncomment the next line to load a uint8 greyscale image
        //var imageId = 'example://1';
        
        // Uncomment the next line to load an RGB image
        //var imageId = 'https://upload.wikimedia.org/wikipedia/commons/7/7d/Renal_Cell_Carcinoma.jpg';
        
        var element = document.getElementById('dicomImage');
        var elementWebGL = document.getElementById('dicomImageWebGL');



        // setup handlers before we display the image
        function onImageRendered(e, eventData) {
            // set the canvas context to the image coordinate system
            cornerstone.setToPixelCoordinateSystem(eventData.enabledElement, eventData.canvasContext);

            $(eventData.element).siblings('.topright').text("Render Time:" + eventData.renderTimeInMs + " ms");
            $(eventData.element).siblings('.bottomleft').text("WW/WL:" + Math.round(eventData.viewport.voi.windowWidth) + "/" + Math.round(eventData.viewport.voi.windowCenter));
            $(eventData.element).siblings('.bottomright').text("Zoom:" + eventData.viewport.scale.toFixed(2));

        }
        $(element).on("CornerstoneImageRendered", onImageRendered);
        $(elementWebGL).on("CornerstoneImageRendered", onImageRendered);

        $("#RGB").on('click', function() {
            loadImage('https://upload.wikimedia.org/wikipedia/commons/7/7d/Renal_Cell_Carcinoma.jpg');
        })

        $("#uint8").on('click', function() {
            loadImage('example://1');
        })

        $("#int16").on('click', function() {
            loadImage('dicomweb:http://jpx.jfpb.net/data/raw.dcm');
        })

        $("#uint16").on('click', function() {
            loadImage(rampImageId);
        })

        function loadImage(elem, imageId) {
            cornerstone.loadAndCacheImage(imageId).then(function(image) {
                cornerstone.displayImage(elem, image);
                var viewport = cornerstone.getDefaultViewportForImage(elem, image);
                cornerstone.setViewport(elem, viewport);
            });
        }

        cornerstone.enable(element);

        cornerstone.loadAndCacheImage(imageId).then(function(image) {
            console.log(image);
            cornerstoneTools.mouseInput.enable(element);
            cornerstoneTools.touchInput.enable(element);
            cornerstoneTools.mouseWheelInput.enable(element);

            cornerstone.displayImage(element, image);

            // Enable mouse controls
            cornerstoneTools.wwwc.activate(element, 1);
            cornerstoneTools.pan.activate(element, 2);
            cornerstoneTools.zoom.activate(element, 4);
            cornerstoneTools.zoomWheel.activate(element);

            // Enable touch controls
            cornerstoneTools.wwwcTouchDrag.activate(element);
            cornerstoneTools.panMultiTouch.activate(element);
            cornerstoneTools.zoomTouchPinch.activate(element);
        });



        cornerstone.enable(elementWebGL, cornerstone.webGL.renderer.render);
        //cornerstone.enable(elementWebGL, "WebGL");

        cornerstone.loadAndCacheImage(imageId).then(function(image) {
            cornerstoneTools.mouseInput.enable(elementWebGL);
            cornerstoneTools.touchInput.enable(elementWebGL);
            cornerstoneTools.mouseWheelInput.enable(elementWebGL);

            cornerstone.webGL.renderer.initRenderer();

            cornerstone.displayImage(elementWebGL, image);

            // Enable mouse controls
            cornerstoneTools.wwwc.activate(elementWebGL, 1);
            cornerstoneTools.pan.activate(elementWebGL, 2);
            cornerstoneTools.zoom.activate(elementWebGL, 4);
            cornerstoneTools.zoomWheel.activate(elementWebGL);

            // Enable touch controls
            cornerstoneTools.wwwcTouchDrag.activate(elementWebGL);
            cornerstoneTools.panMultiTouch.activate(elementWebGL);
            cornerstoneTools.zoomTouchPinch.activate(elementWebGL);
        });


    });

</script>
</html>