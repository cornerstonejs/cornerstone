/*! cornerstone - v0.0.1 - 2014-04-13 | (c) 2014 Chris Hafey | https://github.com/chafey/cornerstone */
!function(){"use strict";function a(){var a=0,b=/MSIE (\d+\.\d+);/.test(navigator.userAgent),c=!!navigator.userAgent.match(/Trident\/7.0/),d=navigator.userAgent.indexOf("rv:11.0");return b&&(a=new Number(RegExp.$1)),-1!=navigator.appVersion.indexOf("MSIE 10")&&(a=10),c&&-1!=d&&(a=11),a}var b=a();11>=b&&!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.Event.prototype,window.CustomEvent=a}()}();var cornerstone=function(a){"use strict";function b(a){i.width=a.width,i.height=a.height,f=i.getContext("2d"),f.fillStyle="white",f.fillRect(0,0,i.width,i.height),g=f.getImageData(0,0,a.width,a.height)}function c(b,c){return void 0!==b.lut&&b.lut.windowCenter===c.windowCenter&&b.lut.windowWidth===c.windowWidth&&b.lut.invert===c.invert?b.lut:(b.lut=a.generateLut(b,c.windowWidth,c.windowCenter,c.invert),b.lut.windowWidth=c.windowWidth,b.lut.windowCenter=c.windowCenter,b.lut.invert=c.invert,b.lut)}function d(a,b){return b.imageId!==h||j.windowCenter!==a.viewport.windowCenter||j.windowWidth!==a.viewport.windowWidth||j.invert!==a.viewport.invert?!0:!1}function e(e,k){var l=new Date,m=e.canvas.getContext("2d");if(m.setTransform(1,0,0,1,0,0),m.fillStyle="black",m.fillRect(0,0,e.canvas.width,e.canvas.height),m.save(),a.setToPixelCoordinateSystem(e,m),d(e,k)){(i.width!==k.width||i.height!=k.height)&&b(k);var n=c(k,e.viewport);a.storedPixelDataToCanvasImageData(k,n,g.data),f.putImageData(g,0,0),h=k.imageId,j.windowCenter=e.viewport.windowCenter,j.windowWidth=e.viewport.windowWidth,j.invert=e.viewport.invert}e.viewport.pixelReplication===!0?(m.imageSmoothingEnabled=!1,m.mozImageSmoothingEnabled=!1):(m.imageSmoothingEnabled=!0,m.mozImageSmoothingEnabled=!0),m.drawImage(i,0,0,k.width,k.height,0,0,k.width,k.height),m.restore();var o=new Date,p=o-l;a.lastRenderTimeInMs=p;var q=new CustomEvent("CornerstoneImageRendered",{detail:{canvasContext:m,viewport:e.viewport,image:e.image,element:e.element,enabledElement:e},bubbles:!1,cancelable:!1});e.element.dispatchEvent(q)}void 0===a&&(a={});var f,g,h,i=document.createElement("canvas"),j={};return a.drawImage=e,a}(cornerstone),cornerstone=function(a){"use strict";function b(b,c,d){var e=document.createElement("canvas");b.appendChild(e);var f={element:b,canvas:e,image:void 0,imageId:"",imageIdHistory:[],data:{}};a.addEnabledElement(f),a.resize(b,!0),a.showImage(b,c,d)}return void 0===a&&(a={}),a.enable=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b);return d.data.hasOwnProperty(c)===!1&&(d.data[c]={}),d.data[c]}function c(b,c){var d=a.getEnabledElement(b);delete d.data[c]}return void 0===a&&(a={}),a.getElementData=b,a.removeElementData=c,a}(cornerstone),cornerstone=function(a){"use strict";function b(a){for(var b=0;b<e.length;b++)if(e[b].element==a)return e[b];return void 0}function c(a){e.push(a)}function d(a){for(var b=0;b<e.length;b++)if(e[b].element===a)return e[b].element.removeChild(e[b].canvas),void e.splice(b,1)}void 0===a&&(a={});var e=[];return a.getEnabledElement=b,a.addEnabledElement=c,a.removeEnabledElement=d,a}(cornerstone),cornerstone=function(a){"use strict";function b(b){var c=a.getEnabledElement(b),d=a.getDefaultViewport(c.canvas,c.image);c.viewport.scale=d.scale,c.viewport.centerX=d.centerX,c.viewport.centerY=d.centerY,a.updateImage(b)}return void 0===a&&(a={}),a.fitToWindow=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(a,b,c,d){var e,f,g,h,i=[],j=a.maxPixelValue,k=a.slope,l=a.intercept,m=b,n=c;if(d===!0)for(h=a.minPixelValue;j>=h;h++)e=h*k+l,f=255*((e-n)/m+.5),g=Math.min(Math.max(f,0),255),i[h]=Math.round(255-g);else for(h=a.minPixelValue;j>=h;h++)e=h*k+l,f=255*((e-n)/m+.5),g=Math.min(Math.max(f,0),255),i[h]=Math.round(g);return i}return void 0===a&&(a={}),a.generateLut=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(a,b){var c={scale:1,centerX:0,centerY:0,windowWidth:b.windowWidth,windowCenter:b.windowCenter,invert:b.invert,pixelReplication:!1},d=a.height/b.rows,e=a.width/b.columns;return c.scale=d>e?e:d,c}return void 0===a&&(a={}),a.getDefaultViewport=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(b,c,d,e,f){c=Math.round(c),d=Math.round(d);for(var g=a.getEnabledElement(b),h=[],i=0,j=0;f>j;j++)for(var k=0;e>k;k++){var l=(j+d)*g.image.columns+(k+c);h[i++]=g.image.storedPixelData[l]}return h}return void 0===a&&(a={}),a.getStoredPixels=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(a){var b,c=a.indexOf(":"),d=a.substring(0,c),e=g[d];return void 0===e||null===e?void 0!==f?b=f(a):void 0:b=e(a)}function c(a){if(void 0===h[a]){var c=b(a);return h[a]=c,c}return h[a]}function d(a,b){g[a]=b}function e(a){var b=f;return f=a,b}void 0===a&&(a={});var f,g={},h={};return a.loadImage=c,a.registerImageLoader=d,a.registerUnknownImageLoader=e,a}(cornerstone),cornerstone=function(a){"use strict";function b(b,c,d){var e=a.getEnabledElement(b);if(void 0===e.image)return{x:0,y:0};var f=b.getBoundingClientRect(),g=c-f.left-window.scrollX,h=d-f.top-window.scrollY,i=g-f.width/2,j=h-f.height/2,k=e.viewport,l=e.viewport.scale,m=e.viewport.scale;e.image.rowPixelSpacing<e.image.columnPixelSpacing?l*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(m*=e.image.rowPixelSpacing/e.image.columnPixelSpacing);var n=i/l,o=j/m,p=n-k.centerX,q=o-k.centerY;return p+=e.image.columns/2,q+=e.image.rows/2,{x:p,y:q}}return void 0===a&&(a={}),a.pageToPixel=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(a,b){var c=window.devicePixelRatio;void 0===c&&(c=1),b.width=a.clientWidth*c,b.height=a.clientHeight*c,b.style.width=a.clientWidth+"px",b.style.height=a.clientHeight+"px"}function c(c,d){var e=a.getEnabledElement(c);b(c,e.canvas),void 0!==e.image&&(d===!0?a.fitToWindow(c):a.updateImage(c))}return void 0===a&&(a={}),a.resize=c,a}(cornerstone),cornerstone=function(a){"use strict";function b(a,b,c){b.setTransform(1,0,0,1,0,0),b.translate(a.canvas.width/2,a.canvas.height/2);var d=a.viewport.scale,e=a.viewport.scale;a.image.rowPixelSpacing<a.image.columnPixelSpacing?d*=a.image.columnPixelSpacing/a.image.rowPixelSpacing:a.image.columnPixelSpacing<a.image.rowPixelSpacing&&(e*=a.image.rowPixelSpacing/a.image.columnPixelSpacing),b.scale(d,e),b.translate(a.viewport.centerX,a.viewport.centerY),void 0===c?c=1:b.scale(c,c),b.translate(-a.image.width/2/c,-a.image.height/2/c)}return void 0===a&&(a={}),a.setToPixelCoordinateSystem=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(b,c,d){var e=a.getEnabledElement(b);e.imageIdHistory.unshift(c);var f=a.loadImage(c);f.done(function(f){for(var g=0;g<e.imageIdHistory.length;g++)if(e.imageIdHistory[g]===f.imageId){e.imageId=c;var h=e.imageIdHistory.length-g;if(e.imageIdHistory.splice(g,h),e.image=f,void 0===e.viewport&&(e.viewport=a.getDefaultViewport(e.canvas,f)),e.viewport=a.getDefaultViewport(e.canvas,f),d)for(var i in d)null!==d[i]&&(e.viewport[i]=d[i]);a.updateImage(b);var j=new CustomEvent("CornerstoneViewportUpdated",{detail:{viewport:e.viewport,element:b,image:e.image},bubbles:!1,cancelable:!1});return b.dispatchEvent(j),j=new CustomEvent("CornerstoneNewImage",{detail:{viewport:e.viewport,element:b,image:e.image},bubbles:!1,cancelable:!1}),void b.dispatchEvent(j)}})}return void 0===a&&(a={}),a.showImage=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(a,b,c){for(var d=3,e=0,f=a.width*a.height,g=a.storedPixelData,h=b,i=c;f>e;)i[d]=h[g[e++]],d+=4}return void 0===a&&(a={}),a.storedPixelDataToCanvasImageData=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(b){var c=a.getEnabledElement(b),d=c.image;void 0!==d&&a.drawImage(c,d)}return void 0===a&&(a={}),a.updateImage=b,a}(cornerstone),cornerstone=function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b);c.windowWidth<1&&(c.windowWidth=1),c.scale<1e-4&&(c.scale=.25),d.viewport=c,a.updateImage(b);var e=new CustomEvent("CornerstoneViewportUpdated",{detail:{viewport:c,element:b,image:d.image},bubbles:!1,cancelable:!1});b.dispatchEvent(e)}function c(b){return a.getEnabledElement(b).viewport}return void 0===a&&(a={}),a.getViewport=c,a.setViewport=b,a}(cornerstone);