/*! cornerstone - v0.10.6 - 2017-04-12 | (c) 2014 Chris Hafey | https://github.com/chafey/cornerstone */

"undefined"==typeof cornerstone&&(cornerstone={internal:{},rendering:{},colors:{}}),function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b),e=a.internal.getTransform(d);return e.invert(),e.transformPoint(c.x,c.y)}a.canvasToPixel=b}(cornerstone),function(a){function b(a,b,c){c=null==c?100:c;for(var d=(b-a)/(c-1),e=[];c-- >0;)e.push(a),a+=d;return e[e.length-1]=b,e}function c(a,b){for(var c=0,d=a.length-1;c<=d;){var e=c+Math.floor((d-c)/2),f=a[e];if(f===b)return e;b<f?d=e-1:c=e+1}return c}function d(a,b){var d,e=[],f=b.length;for(a.sort(function(a,b){return a-b}),d=0;d<f;d++)e[d]=c(a,b[d]);return e}function e(a,c,e){var f,g=[],h=[],i=[],j=[];for(e=null==e?1:e,f=0;f<c.length;f++){var k=c[f];g.push((a-1)*k[0]),h.push(k[1]),i.push(k[1])}var l=b(0,1,a);for(f=0;f<a;f++)l[f]=(a-1)*Math.pow(l[f],e);var m=d(g,l);for(f=1;f<a-1;f++){var n=m[f],o=(l[f]-g[n-1])/(g[n]-g[n-1]),p=h[n]-i[n-1];j[f]=o*p+i[n-1]}return j[0]=i[0],j[a-1]=h[c.length-1],j}function f(a,b,c){var d,f=[];b=null==b?256:b,c=null==c?1:c;var g=e(b,a.red,c),h=e(b,a.green,c),i=e(b,a.blue,c);for(d=0;d<b;d++){var j=Math.round(255*g[d]),k=Math.round(255*h[d]),l=Math.round(255*i[d]),m=[j,k,l,255];f.push(m)}return f}function g(){var a=[];return Object.keys(j).forEach(function(b){if(j.hasOwnProperty(b)){var c=j[b];a.push({id:b,name:c.name})}}),a.sort(function(a,b){var c=a.name.toLowerCase(),d=b.name.toLowerCase();return c===d?0:c<d?-1:1}),a}function h(b,c){var d=j[b];return d||(d=j[b]=c||{name:"",colors:[]}),!d.colors&&d.segmentedData&&(d.colors=f(d.segmentedData,d.numColors,d.gamma)),{getId:function(){return b},getColorSchemeName:function(a){return d.name},setColorSchemeName:function(a){d.name=a},getNumberOfColors:function(){return d.colors.length},setNumberOfColors:function(a){for(;d.colors.length<a;)d.colors.push(i);d.colors.length=a},getColor:function(a){return this.isValidIndex(a)?d.colors[a]:i},getColorRepeating:function(a){var b=d.colors.length;return a=b?a%b:0,this.getColor(a)},setColor:function(a,b){this.isValidIndex(a)&&(d.colors[a]=b)},addColor:function(a){d.colors.push(a)},insertColor:function(a,b){this.isValidIndex(a)&&d.colors.splice(a,1,b)},removeColor:function(a){this.isValidIndex(a)&&d.colors.splice(a,1)},clearColors:function(){d.colors=[]},buildLookupTable:function(a){if(a){var b,c=d.colors.length;for(a.setNumberOfTableValues(c),b=0;b<c;b++)a.setTableValue(b,d.colors[b])}},createLookupTable:function(){var b=new a.colors.LookupTable;return this.buildLookupTable(b),b},isValidIndex:function(a){return a>=0&&a<d.colors.length}}}var i=[0,0,0,255],j={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};a.colors.getColormap=h,a.colors.getColormapsList=g}(cornerstone),function(a){"use strict";function b(){this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[],this.setNumberOfTableValues=function(a){this.NumberOfColors=a},this.setRamp=function(a){this.Ramp=a},this.setTableRange=function(a,b){this.TableRange[0]=a,this.TableRange[1]=b},this.setHueRange=function(a,b){this.HueRange[0]=a,this.HueRange[1]=b},this.setSaturationRange=function(a,b){this.SaturationRange[0]=a,this.SaturationRange[1]=b},this.setValueRange=function(a,b){this.ValueRange[0]=a,this.ValueRange[1]=b},this.setRange=function(a,b){this.InputRange[0]=a,this.InputRange[1]=b},this.setAlphaRange=function(a,b){this.AlphaRange[0]=a,this.AlphaRange[1]=b},this.getColor=function(a){return this.mapValue(a)},this.getOpacity=function(){return opacity},this.HSVToRGB=function(a,b,c){if(a>1)throw"HSVToRGB expects hue < 1";var d=[];if(0===b)return d[0]=c,d[1]=c,d[2]=c,d;var e=Math.floor(6*a),f=6*a-e,g=c*(1-b),h=c*(1-b*f),i=c*(1-b*(1-f));switch(e){case 0:case 6:d[0]=c,d[1]=i,d[2]=g;break;case 1:d[0]=h,d[1]=c,d[2]=g;break;case 2:d[0]=g,d[1]=c,d[2]=i;break;case 3:d[0]=g,d[1]=h,d[2]=c;break;case 4:d[0]=i,d[1]=g,d[2]=c;break;case 5:d[0]=c,d[1]=g,d[2]=h}return d},this.build=function(a){if(!(this.Table.length>1)||a){this.Table=[];var b,c,d,e,f=this.NumberOfColors-1;f?(b=(this.HueRange[1]-this.HueRange[0])/f,c=(this.SaturationRange[1]-this.SaturationRange[0])/f,d=(this.ValueRange[1]-this.ValueRange[0])/f,e=(this.AlphaRange[1]-this.AlphaRange[0])/f):b=c=d=e=0;for(var g=0;g<=f;g++){var h=this.HueRange[0]+g*b,i=this.SaturationRange[0]+g*c,j=this.ValueRange[0]+g*d,k=this.AlphaRange[0]+g*e,l=this.HSVToRGB(h,i,j),m=[];switch(this.Ramp){case"scurve":m[0]=Math.floor(127.5*(1+Math.cos((1-l[0])*Math.PI))),m[1]=Math.floor(127.5*(1+Math.cos((1-l[1])*Math.PI))),m[2]=Math.floor(127.5*(1+Math.cos((1-l[2])*Math.PI))),m[3]=Math.floor(255*k);break;case"linear":m[0]=Math.floor(255*l[0]+.5),m[1]=Math.floor(255*l[1]+.5),m[2]=Math.floor(255*l[2]+.5),m[3]=Math.floor(255*k+.5);break;case"sqrt":m[0]=Math.floor(255*Math.sqrt(l[0])+.5),m[1]=Math.floor(255*Math.sqrt(l[1])+.5),m[2]=Math.floor(255*Math.sqrt(l[2])+.5),m[3]=Math.floor(255*Math.sqrt(k)+.5);break;default:throw new Error("Invalid Ramp value ("+this.Ramp+")")}this.Table.push(m)}this.buildSpecialColors()}},this.buildSpecialColors=function(){var a=this.NumberOfColors,b=a+c,f=a+d,g=a+e;this.UseBelowRangeColor||0===a?this.Table[b]=this.BelowRangeColor:this.Table[b]=this.Table[0],this.UseAboveRangeColor||0===a?this.Table[f]=this.AboveRangeColor:this.Table[f]=this.Table[a-1],this.Table[g]=this.NaNColor},this.mapValue=function(a){var b=this.getIndex(a);if(b<0)return this.NaNColor;if(0===b){if(this.UseBelowRangeColor&&a<this.TableRange[0])return this.BelowRangeColor}else if(b===this.NumberOfColors-1&&this.UseAboveRangeColor&&a>this.TableRange[1])return this.AboveRangeColor;return this.Table[b]},this.linearIndexLookupMain=function(a,b){var e;return e=a<b.Range[0]?b.MaxIndex+c+1.5:a>b.Range[1]?b.MaxIndex+d+1.5:(a+b.Shift)*b.Scale,Math.round(e)},this.getIndex=function(a){var b={};if(b.Range=[],b.MaxIndex=this.NumberOfColors-1,b.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?b.Scale=Number.MAX_VALUE:b.Scale=b.MaxIndex/(this.TableRange[1]-this.TableRange[0]),b.Range[0]=this.TableRange[0],b.Range[1]=this.TableRange[1],isNaN(a))return-1;var e=this.linearIndexLookupMain(a,b);return e===this.NumberOfColors+c?e=0:e===this.NumberOfColors+d&&(e=this.NumberOfColors-1),e},this.setTableValue=function(a,b){if(5===arguments.length&&(b=Array.prototype.slice.call(arguments,1)),a<0)throw new Error("Can't set the table value for negative index ("+a+")");a>=this.NumberOfColors&&new Error("Index "+a+" is greater than the number of colors "+this.NumberOfColors),this.Table[a]=b,0!==a&&a!==this.NumberOfColors-1||this.buildSpecialColors()}}var c=0,d=1,e=2;a.colors.LookupTable=b}(cornerstone),function(a){"use strict";function b(b){if(void 0===b)throw"disable: element element must not be undefined";for(var c=a.getEnabledElements(),d=0;d<c.length;d++)if(c[d].element===b){var e={element:b};return $(b).trigger("CornerstoneElementDisabled",e),c[d].element.removeChild(c[d].canvas),c[d].canvas=void 0,void c.splice(d,1)}}a.disable=b}(cornerstone),function(a,b){"use strict";function c(c,d,e){if(void 0===c)throw"displayImage: parameter element cannot be undefined";if(void 0===d)throw"displayImage: parameter image cannot be undefined";var f=b.getEnabledElement(c);if(f.image=d,void 0===f.viewport&&(f.viewport=b.internal.getDefaultViewport(f.canvas,d)),e)for(var g in e)null!==e[g]&&(f.viewport[g]=e[g]);var h,i=new Date;if(void 0!==f.lastImageTimeStamp){h=(1e3/(i.getTime()-f.lastImageTimeStamp)).toFixed()}f.lastImageTimeStamp=i.getTime();var j={viewport:f.viewport,element:f.element,image:f.image,enabledElement:f,frameRate:h};a(f.element).trigger("CornerstoneNewImage",j),b.updateImage(c)}b.displayImage=c}($,cornerstone),function(a,b){"use strict";function c(a){var c=b.getEnabledElement(a);if(void 0===c.image)throw"draw: image has not been loaded yet";b.drawImage(c)}b.draw=c}($,cornerstone),function(a,b){"use strict";function c(){for(var a=b.getEnabledElements(),c=0;c<a.length;c++){var d=a[c];!0===d.invalid&&b.drawImage(d,!0)}}b.drawInvalidated=c}($,cornerstone),function(a){"use strict";function b(b,c){function d(){if(void 0!==f.canvas){if(f.needsRedraw&&void 0!==f.image){var b=new Date,c=f.image.render;c||(c=f.image.color?a.renderColorImage:a.renderGrayscaleImage),c(f,f.invalid);var e=f.canvas.getContext("2d"),g=new Date,h=g-b,i={viewport:f.viewport,element:f.element,image:f.image,enabledElement:f,canvasContext:e,renderTimeInMs:h};f.invalid=!1,f.needsRedraw=!1,$(f.element).trigger("CornerstoneImageRendered",i)}a.requestAnimationFrame(d)}}if(void 0===b)throw"enable: parameter element cannot be undefined"
;c&&c.renderer&&"webgl"===c.renderer.toLowerCase()&&(a.webGL.renderer.isWebGLAvailable()?(console.log("Using WebGL rendering path"),a.webGL.renderer.initRenderer(),c.renderer="webgl"):(console.error("WebGL not available, falling back to Canvas renderer"),delete c.renderer));var e=document.createElement("canvas");b.appendChild(e);var f={element:b,canvas:e,image:void 0,invalid:!1,needsRedraw:!0,options:c,data:{}};return a.addEnabledElement(f),a.resize(b,!0),d(),b}a.enable=b}(cornerstone),function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b);return!1===d.data.hasOwnProperty(c)&&(d.data[c]={}),d.data[c]}function c(b,c){delete a.getEnabledElement(b).data[c]}a.getElementData=b,a.removeElementData=c}(cornerstone),function(a){"use strict";function b(a){if(void 0===a)throw"getEnabledElement: parameter element must not be undefined";for(var b=0;b<f.length;b++)if(f[b].element==a)return f[b];throw"element not enabled"}function c(a){if(void 0===a)throw"getEnabledElement: enabledElement element must not be undefined";f.push(a)}function d(a){var b=[];return f.forEach(function(c){c.image&&c.image.imageId===a&&b.push(c)}),b}function e(){return f}var f=[];a.getEnabledElement=b,a.addEnabledElement=c,a.getEnabledElementsByImageId=d,a.getEnabledElements=e}(cornerstone),function(a){"use strict";function b(a){for(var b,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=a.length,f=0;f<e;f++)b=a[f],c=c<b?c:b,d=d>b?d:b;return{minPixelValue:c,maxPixelValue:d}}function c(a){if(a.restore)return a.restore;var b=a.color,c=a.rgba,d=a.lut,e=a.slope,f=a.windowWidth,g=a.windowCenter,h=a.minPixelValue,i=a.maxPixelValue;return function(){if(a.color=b,a.rgba=c,a.lut=d,a.slope=e,a.windowWidth=f,a.windowCenter=g,a.minPixelValue=h,a.maxPixelValue=i,a.origPixelData){var j=a.origPixelData;a.getPixelData=function(){return j}}delete a.origPixelData,delete a.colormapId,delete a.falseColor}}function d(b){return b&&"string"==typeof b&&(b=a.colors.getColormap(b)),b}function e(a){return!(!a.restore||"function"!=typeof a.restore)&&(a.restore(),!0)}function f(f,g){if(f.color&&!f.falseColor)throw"Color transforms are not implemented yet";g=d(g);var h=g.getId();if(f.colormapId===h)return!1;if(e(f),h){var i,j=f.minPixelValue||0,k=f.maxPixelValue||255;f.restore=c(f),i=g.createLookupTable(),i.setTableRange(j,k),a.pixelDataToFalseColorData(f,i);var l=b(f.getPixelData());f.minPixelValue=l.minPixelValue,f.maxPixelValue=l.maxPixelValue,f.colormapId=h}return!0}function g(b,c){f(a.getEnabledElement(b).image,c)&&a.updateImage(b,!0)}a.convertImageToFalseColorImage=f,a.convertToFalseColorImage=g,a.restoreImage=e}(cornerstone),function(a){"use strict";function b(a){return 0===a.viewport.rotation||180===a.viewport.rotation?{width:a.image.width,height:a.image.height}:{width:a.image.height,height:a.image.width}}function c(c){var d=a.getEnabledElement(c),e=b(d),f=d.canvas.height/e.height,g=d.canvas.width/e.width;d.viewport.scale=g<f?g:f,d.viewport.translation.x=0,d.viewport.translation.y=0,a.updateImage(c)}a.fitToWindow=c}(cornerstone),function(a,b){"use strict";function c(a,c){var d=b.getEnabledElement(a);return b.internal.getDefaultViewport(d.canvas,c)}b.getDefaultViewportForImage=c}($,cornerstone),function(a,b){"use strict";function c(a){return b.getEnabledElement(a).image}b.getImage=c}($,cornerstone),function(a){"use strict";function b(b,c,d,e,f){var g=a.getStoredPixels(b,c,d,e,f),h=a.getEnabledElement(b),i=a.internal.getModalityLUT(h.image.slope,h.image.intercept,h.viewport.modalityLUT);return g.map(i)}a.getPixels=b}(cornerstone),function(a){"use strict";function b(b,c,d,e,f){if(void 0===b)throw"getStoredPixels: parameter element must not be undefined";c=Math.round(c),d=Math.round(d);for(var g=a.getEnabledElement(b),h=[],i=0,j=g.image.getPixelData(),k=0;k<f;k++)for(var l=0;l<e;l++){var m=(k+d)*g.image.columns+(l+c);h[i++]=j[m]}return h}a.getStoredPixels=b}(cornerstone),function(a){"use strict";function b(b){var c=a.getEnabledElement(b),d=c.viewport;if(void 0!==d)return{scale:d.scale,translation:{x:d.translation.x,y:d.translation.y},voi:{windowWidth:d.voi.windowWidth,windowCenter:d.voi.windowCenter},invert:d.invert,pixelReplication:d.pixelReplication,rotation:d.rotation,hflip:d.hflip,vflip:d.vflip,modalityLUT:d.modalityLUT,voiLUT:d.voiLUT}}a.getViewport=b}(cornerstone),function(a){"use strict";function b(a){if(void 0===a)throw"setMaximumSizeBytes: parameter numBytes must not be undefined";if(void 0===a.toFixed)throw"setMaximumSizeBytes: parameter numBytes must be a number";m=a,c()}function c(){function b(a,b){return a.timeStamp>b.timeStamp?-1:a.timeStamp<b.timeStamp?1:0}if(!(n<=m)){for(l.sort(b);n>m;){var c=l[l.length-1],d=c.imageId;f(d),$(a).trigger("CornerstoneImageCachePromiseRemoved",{imageId:d})}var e=a.imageCache.getCacheInfo();$(a).trigger("CornerstoneImageCacheFull",e)}}function d(a,b){if(void 0===a)throw"getImagePromise: imageId must not be undefined";if(void 0===b)throw"getImagePromise: imagePromise must not be undefined";if(!0===k.hasOwnProperty(a))throw"putImagePromise: imageId already in cache";var d={loaded:!1,imageId:a,sharedCacheKey:void 0,imagePromise:b,timeStamp:new Date,sizeInBytes:0};k[a]=d,l.push(d),b.then(function(a){if(d.loaded=!0,d.image=a,void 0===a.sizeInBytes)throw"putImagePromise: image does not have sizeInBytes property or";if(void 0===a.sizeInBytes.toFixed)throw"putImagePromise: image.sizeInBytes is not a number";d.sizeInBytes=a.sizeInBytes,n+=d.sizeInBytes,d.sharedCacheKey=a.sharedCacheKey,c()})}function e(a){if(void 0===a)throw"getImagePromise: imageId must not be undefined";var b=k[a];if(void 0!==b)return b.timeStamp=new Date,b.imagePromise}function f(a){if(void 0===a)throw"removeImagePromise: imageId must not be undefined";var b=k[a];if(void 0===b)throw"removeImagePromise: imageId must not be undefined";return b.imagePromise.reject(),l.splice(l.indexOf(b),1),n-=b.sizeInBytes,h(b.imagePromise,b.imageId),delete k[a],b.imagePromise}function g(){return{maximumSizeInBytes:m,cacheSizeInBytes:n,numberOfImagesCached:l.length}}function h(a,b){a.then(function(a){a.decache&&a.decache()}).always(function(){delete k[b]})}function i(){for(;l.length>0;){f(l[0].imageId)}}function j(a,b){var c=k[a];c&&c.imagePromise.then(function(a){var c=b-a.sizeInBytes;a.sizeInBytes=b,n+=c})}var k={},l=[],m=1073741824,n=0;a.imageCache={putImagePromise:d,getImagePromise:e,removeImagePromise:f,setMaximumSizeBytes:b,getCacheInfo:g,purgeCache:i,cachedImages:l,imageCache:k,changeImageIdCacheSize:j}}(cornerstone),function(a,b){"use strict";function c(c,d){var e,f=c.indexOf(":"),g=c.substring(0,f),j=i[g];return void 0===j||null===j?void 0!==h?e=h(c):void 0:(e=j(c,d),e.then(function(c){a(b).trigger("CornerstoneImageLoaded",{image:c})}),e)}function d(a,d){if(void 0===a)throw"loadImage: parameter imageId must not be undefined";var e=b.imageCache.getImagePromise(a);if(void 0!==e)return e;if(void 0===(e=c(a,d)))throw"loadImage: no image loader for imageId";return e}function e(a,d){if(void 0===a)throw"loadAndCacheImage: parameter imageId must not be undefined";var e=b.imageCache.getImagePromise(a);if(void 0!==e)return e;if(void 0===(e=c(a,d)))throw"loadAndCacheImage: no image loader for imageId";return b.imageCache.putImagePromise(a,e),e}function f(a,b){i[a]=b}function g(a){var b=h;return h=a,b}var h,i={};b.loadImage=d,b.loadAndCacheImage=e,b.registerImageLoader=f,b.registerUnknownImageLoader=g}($,cornerstone),function(a){"use strict";function b(b,c){var d=new a.internal.Transform;d.translate(b.canvas.width/2,b.canvas.height/2);var e=b.viewport.rotation;0!==e&&d.rotate(e*Math.PI/180);var f=b.viewport.scale,g=b.viewport.scale;return b.image.rowPixelSpacing<b.image.columnPixelSpacing?f*=b.image.columnPixelSpacing/b.image.rowPixelSpacing:b.image.columnPixelSpacing<b.image.rowPixelSpacing&&(g*=b.image.rowPixelSpacing/b.image.columnPixelSpacing),d.scale(f,g),0!==e&&d.rotate(-e*Math.PI/180),d.translate(b.viewport.translation.x,b.viewport.translation.y),0!==e&&d.rotate(e*Math.PI/180),void 0!==c&&d.scale(c,c),b.viewport.hflip&&d.scale(-1,1),b.viewport.vflip&&d.scale(1,-1),d.translate(-b.image.width/2,-b.image.height/2),d}a.internal.calculateTransform=b}(cornerstone),function(a,b){"use strict";function c(a,b){a.needsRedraw=!0,b&&(a.invalid=!0)}b.internal.drawImage=c,b.drawImage=c}($,cornerstone),function(a){"use strict";function b(b,c,d,e,f,g){void 0===b.lut&&(b.lut=new Int16Array(b.maxPixelValue-Math.min(b.minPixelValue,0)+1));var h=b.lut,i=b.maxPixelValue,j=b.minPixelValue,k=a.internal.getModalityLUT(b.slope,b.intercept,f),l=a.internal.getVOILUT(c,d,g),m=0;j<0&&(m=j);var n,o,p,q;for(n=b.minPixelValue;n<=i;n++)o=k(n),p=l(o),q=Math.min(Math.max(p,0),255),h[n+-m]=e?Math.round(255-q):Math.round(q);return h}function c(a,c,d,e,f,g){if(f||g)return b(a,c,d,e,f,g);void 0===a.lut&&(a.lut=new Int16Array(a.maxPixelValue-Math.min(a.minPixelValue,0)+1));var h,i,j,k,l=a.lut,m=a.maxPixelValue,n=a.minPixelValue,o=a.slope,p=a.intercept,q=c,r=d,s=0;if(n<0&&(s=n),!0===e)for(k=a.minPixelValue;k<=m;k++)h=k*o+p,i=255*((h-r)/q+.5),j=Math.min(Math.max(i,0),255),l[k+-s]=Math.round(255-j);else for(k=a.minPixelValue;k<=m;k++)h=k*o+p,i=255*((h-r)/q+.5),j=Math.min(Math.max(i,0),255),l[k+-s]=Math.round(j)}a.internal.generateLutNew=b,a.internal.generateLut=c,a.generateLutNew=b,a.generateLut=c}(cornerstone),function(a){"use strict";function b(a,b){if(void 0===a)throw"getDefaultViewport: parameter canvas must not be undefined";if(void 0===b)throw"getDefaultViewport: parameter image must not be undefined";var c={scale:1,translation:{x:0,y:0},voi:{windowWidth:b.windowWidth,windowCenter:b.windowCenter},invert:b.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:b.modalityLUT,voiLUT:b.voiLUT},d=a.height/b.rows,e=a.width/b.columns;return c.scale=e<d?e:d,c}a.internal.getDefaultViewport=b,a.getDefaultViewport=b}(cornerstone),function(a){"use strict";function b(b){return a.internal.calculateTransform(b)}a.internal.getTransform=b}(cornerstone),function(a,b){"use strict";b.drawImage=b.internal.drawImage,b.generateLut=b.internal.generateLut,b.storedPixelDataToCanvasImageData=b.internal.storedPixelDataToCanvasImageData,b.storedColorPixelDataToCanvasImageData=b.internal.storedColorPixelDataToCanvasImageData}($,cornerstone),function(a){"use strict";function b(a,b){var c=a,d=b;return function(a){return a*c+d}}function c(a){var b=a.lut[0],c=a.lut[a.lut.length-1],d=a.firstValueMapped+a.lut.length;return function(e){return e<a.firstValueMapped?b:e>=d?c:a.lut[e]}}function d(a,d,e){return e?c(e):b(a,d)}a.internal.getModalityLUT=d}(cornerstone),function(a){"use strict";function b(a){window.setTimeout(a,1e3/60)}function c(a){return window.requestAnimationFrame(a)||window.webkitRequestAnimationFrame(a)||window.mozRequestAnimationFrame(a)||window.oRequestAnimationFrame(a)||window.msRequestAnimationFrame(a)||b(a)}a.requestAnimationFrame=c}(cornerstone),function(a){"use strict";function b(a,b,c){var d=a.minPixelValue,e=0,f=0,g=a.width*a.height*4,h=a.getPixelData(),i=b,j=c;!function(){if(d<0)for(;f<g;)j[e++]=i[h[f++]+-d],j[e++]=i[h[f++]+-d],j[e]=i[h[f]+-d],f+=2,e+=2;else for(;f<g;)j[e++]=i[h[f++]],j[e++]=i[h[f++]],j[e]=i[h[f]],f+=2,e+=2}()}a.internal.storedColorPixelDataToCanvasImageData=b,a.storedColorPixelDataToCanvasImageData=b}(cornerstone),function(a){"use strict";function b(a,b,c){var d=a.getPixelData(),e=a.minPixelValue,f=3,g=0,h=d.length,i=d,j=b,k=c;!function(){if(e<0)for(;g<h;)k[f]=j[i[g++]+-e],f+=4;else for(;g<h;)k[f]=j[i[g++]],f+=4}()}a.internal.storedPixelDataToCanvasImageData=b,a.storedPixelDataToCanvasImageData=b}(cornerstone),function(a){"use strict";function b(){this.reset()}b.prototype.reset=function(){this.m=[1,0,0,1,0,0]},b.prototype.clone=function(){var a=new b;return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a},b.prototype.multiply=function(a){var b=this.m[0]*a.m[0]+this.m[2]*a.m[1],c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],e=this.m[1]*a.m[2]+this.m[3]*a.m[3],f=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],g=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g},b.prototype.invert=function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*a,c=-this.m[1]*a,d=-this.m[2]*a,e=this.m[0]*a,f=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),g=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g},b.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.m[0]*b+this.m[2]*c,e=this.m[1]*b+this.m[3]*c,f=this.m[0]*-c+this.m[2]*b,g=this.m[1]*-c+this.m[3]*b;this.m[0]=d,this.m[1]=e,this.m[2]=f,this.m[3]=g},b.prototype.translate=function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b,this.m[5]+=this.m[1]*a+this.m[3]*b},b.prototype.scale=function(a,b){this.m[0]*=a,this.m[1]*=a,this.m[2]*=b,this.m[3]*=b},b.prototype.transformPoint=function(a,b){var c=a,d=b;return a=c*this.m[0]+d*this.m[2]+this.m[4],b=c*this.m[1]+d*this.m[3]+this.m[5],{x:a,y:b}},a.internal.Transform=b}(cornerstone),function(a){"use strict";function b(a,b){return function(c){return 255*((c-b)/a+.5)}}function c(a){var b=a.numBitsPerEntry-8,c=a.lut[0]>>b,d=a.lut[a.lut.length-1]>>b,e=a.firstValueMapped+a.lut.length-1;return function(f){return f<a.firstValueMapped?c:f>=e?d:a.lut[f-a.firstValueMapped]>>b}}function d(a,d,e){return e?c(e):b(a,d)}a.internal.getVOILUT=d}(cornerstone),function(a){"use strict";function b(b){var c=a.getEnabledElement(b);c.invalid=!0,c.needsRedraw=!0;var d={element:b};$(c.element).trigger("CornerstoneInvalidated",d)}a.invalidate=b}(cornerstone),function(a){"use strict";function b(b){a.getEnabledElementsByImageId(b).forEach(function(b){a.drawImage(b,!0)})}a.invalidateImageId=b}(cornerstone),function(a,b){"use strict";function c(a,b){b=b||0;for(var c=0;c<f.length&&!(f[c].priority<=b);c++);f.splice(c,0,{priority:b,provider:a})}function d(a){for(var b=0;b<f.length;b++)if(f[b].provider===a)return void f.splice(b,1)}function e(a,b){for(var c=0;c<f.length;c++){var d;if(void 0!==(d=f[c].provider(a,b)))return d}}var f=[];b.metaData={addProvider:c,removeProvider:d,get:e}}($,cornerstone),function(a){"use strict";function b(b,c,d){var e=a.getEnabledElement(b);if(void 0===e.image)throw"image has not been loaded yet";var f=(e.image,b.getBoundingClientRect()),g=c-f.left-window.pageXOffset,h=d-f.top-window.pageYOffset,i={x:g,y:h},j=a.internal.getTransform(e);return j.invert(),j.transformPoint(i.x,i.y)}a.pageToPixel=b}(cornerstone),function(a){"use strict";function b(b,c){if(b.color&&!b.falseColor)throw"Color transforms are not implemented yet";var d,e,f=b.minPixelValue,g=0,h=0,i=b.width*b.height,j=b.origPixelData||b.getPixelData(),k=new Uint8Array(4*i),l=c;if(b.color=!0,b.falseColor=!0,b.origPixelData=j,c instanceof a.colors.LookupTable)for(c.build();h<i;)d=j[h++],e=c.mapValue(d),k[g++]=e[0],k[g++]=e[1],k[g++]=e[2],k[g++]=e[3];else if(f<0)for(;h<i;)d=j[h++],k[g++]=l[d+-f][0],k[g++]=l[d+-f][1],k[g++]=l[d+-f][2],k[g++]=l[d+-f][3];else for(;h<i;)d=j[h++],k[g++]=l[d][0],k[g++]=l[d][1],k[g++]=l[d][2],k[g++]=l[d][3];b.rgba=!0,b.lut=void 0,b.slope=1,b.minPixelValue=0,b.maxPixelValue=255,b.windowWidth=255,b.windowCenter=128,b.getPixelData=function(){return k}}a.pixelDataToFalseColorData=b}(cornerstone),function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b);return a.internal.getTransform(d).transformPoint(c.x,c.y)}a.pixelToCanvas=b}(cornerstone),function(a){"use strict";function b(a,b){var c=a.renderingTools.colorRenderCanvas;c.width=b.width,c.height=b.height;var d=c.getContext("2d");d.fillStyle="white",d.fillRect(0,0,c.width,c.height);var e=d.getImageData(0,0,b.width,b.height);a.renderingTools.colorRenderCanvasContext=d,a.renderingTools.colorRenderCanvasData=e}function c(b,c){return void 0!==b.lut&&b.lut.windowCenter===c.voi.windowCenter&&b.lut.windowWidth===c.voi.windowWidth&&b.lut.invert===c.invert?b.lut:(a.generateLut(b,c.voi.windowWidth,c.voi.windowCenter,c.invert),b.lut.windowWidth=c.voi.windowWidth,b.lut.windowCenter=c.voi.windowCenter,b.lut.invert=c.invert,b.lut)}function d(a,b){var c=a.renderingTools.lastRenderedImageId,d=a.renderingTools.lastRenderedViewport;return b.imageId!==c||d.windowCenter!==a.viewport.voi.windowCenter||d.windowWidth!==a.viewport.voi.windowWidth||d.invert!==a.viewport.invert||d.rotation!==a.viewport.rotation||d.hflip!==a.viewport.hflip||d.vflip!==a.viewport.vflip}function e(e,f,g){e.renderingTools.colorRenderCanvas||(e.renderingTools.colorRenderCanvas=document.createElement("canvas"));var h=e.renderingTools.colorRenderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&f.getCanvas&&f.getCanvas())return f.getCanvas();if(!1===d(e,f)&&!0!==g)return h;h.width===f.width&&h.height===f.height||b(e,f);var i=c(f,e.viewport),j=e.renderingTools.colorRenderCanvasData,k=e.renderingTools.colorRenderCanvasContext;return a.storedColorPixelDataToCanvasImageData(f,i,j.data),k.putImageData(j,0,0),h}function f(b,c){if(void 0===b)throw"drawImage: enabledElement parameter must not be undefined";var d=b.image;if(void 0===d)throw"drawImage: image must be loaded before it can be drawn";var f=b.canvas.getContext("2d");f.setTransform(1,0,0,1,0,0),f.fillStyle="black",f.fillRect(0,0,b.canvas.width,b.canvas.height),!0===b.viewport.pixelReplication?(f.imageSmoothingEnabled=!1,f.mozImageSmoothingEnabled=!1):(f.imageSmoothingEnabled=!0,f.mozImageSmoothingEnabled=!0),f.save(),a.setToPixelCoordinateSystem(b,f),b.renderingTools||(b.renderingTools={});var g;g=b.options&&b.options.renderer&&"webgl"===b.options.renderer.toLowerCase()?a.webGL.renderer.render(b):e(b,d,c),f.drawImage(g,0,0,d.width,d.height,0,0,d.width,d.height),f.restore(),b.renderingTools.lastRenderedImageId=d.imageId;var h={};h.windowCenter=b.viewport.voi.windowCenter,h.windowWidth=b.viewport.voi.windowWidth,h.invert=b.viewport.invert,h.rotation=b.viewport.rotation,h.hflip=b.viewport.hflip,h.vflip=b.viewport.vflip,b.renderingTools.lastRenderedViewport=h}a.rendering.colorImage=f,a.renderColorImage=f}(cornerstone),function(a){"use strict";function b(a,b){var c=a.renderingTools.grayscaleRenderCanvas;c.width=b.width,c.height=b.height;var d=c.getContext("2d");d.fillStyle="white",d.fillRect(0,0,c.width,c.height);var e=d.getImageData(0,0,b.width,b.height);a.renderingTools.grayscaleRenderCanvasContext=d,a.renderingTools.grayscaleRenderCanvasData=e}function c(a,b){return!a&&!b||!(!a||!b)&&a.id===b.id}function d(b,d,e){return void 0!==b.lut&&b.lut.windowCenter===d.voi.windowCenter&&b.lut.windowWidth===d.voi.windowWidth&&c(b.lut.modalityLUT,d.modalityLUT)&&c(b.lut.voiLUT,d.voiLUT)&&b.lut.invert===d.invert&&!0!==e?b.lut:(a.generateLut(b,d.voi.windowWidth,d.voi.windowCenter,d.invert,d.modalityLUT,d.voiLUT),b.lut.windowWidth=d.voi.windowWidth,b.lut.windowCenter=d.voi.windowCenter,b.lut.invert=d.invert,b.lut.voiLUT=d.voiLUT,b.lut.modalityLUT=d.modalityLUT,b.lut)}function e(a,b){var c=a.renderingTools.lastRenderedImageId,d=a.renderingTools.lastRenderedViewport;return b.imageId!==c||d.windowCenter!==a.viewport.voi.windowCenter||d.windowWidth!==a.viewport.voi.windowWidth||d.invert!==a.viewport.invert||d.rotation!==a.viewport.rotation||d.hflip!==a.viewport.hflip||d.vflip!==a.viewport.vflip||d.modalityLUT!==a.viewport.modalityLUT||d.voiLUT!==a.viewport.voiLUT}function f(c,f,g){c.renderingTools.grayscaleRenderCanvas||(c.renderingTools.grayscaleRenderCanvas=document.createElement("canvas"));var h=c.renderingTools.grayscaleRenderCanvas;if(!1===e(c,f)&&!0!==g)return h;h.width===f.width&&h.height===f.height||b(c,f);var i=d(f,c.viewport,g),j=c.renderingTools.grayscaleRenderCanvasData,k=c.renderingTools.grayscaleRenderCanvasContext;return a.storedPixelDataToCanvasImageData(f,i,j.data),k.putImageData(j,0,0),h}function g(b,c){if(void 0===b)throw"drawImage: enabledElement parameter must not be undefined";var d=b.image;if(void 0===d)throw"drawImage: image must be loaded before it can be drawn";var e=b.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.fillStyle="black",e.fillRect(0,0,b.canvas.width,b.canvas.height),!0===b.viewport.pixelReplication?(e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1):(e.imageSmoothingEnabled=!0,e.mozImageSmoothingEnabled=!0),a.setToPixelCoordinateSystem(b,e),b.renderingTools||(b.renderingTools={});var g;g=b.options&&b.options.renderer&&"webgl"===b.options.renderer.toLowerCase()?a.webGL.renderer.render(b):f(b,d,c),e.drawImage(g,0,0,d.width,d.height,0,0,d.width,d.height),b.renderingTools.lastRenderedImageId=d.imageId;var h={};h.windowCenter=b.viewport.voi.windowCenter,h.windowWidth=b.viewport.voi.windowWidth,h.invert=b.viewport.invert,h.rotation=b.viewport.rotation,h.hflip=b.viewport.hflip,h.vflip=b.viewport.vflip,h.modalityLUT=b.viewport.modalityLUT,h.voiLUT=b.viewport.voiLUT,b.renderingTools.lastRenderedViewport=h}a.rendering.grayscaleImage=g,a.renderGrayscaleImage=g}(cornerstone),function(a){"use strict";function b(b,c){if(void 0===b)throw"drawImage: enabledElement parameter must not be undefined";var d=b.image;if(void 0===d)throw"drawImage: image must be loaded before it can be drawn";var e=b.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.fillStyle="black",e.fillRect(0,0,b.canvas.width,b.canvas.height),!0===b.viewport.pixelReplication?(e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1):(e.imageSmoothingEnabled=!0,e.mozImageSmoothingEnabled=!0),a.setToPixelCoordinateSystem(b,e),b.viewport.voi.windowWidth===b.image.windowWidth&&b.viewport.voi.windowCenter===b.image.windowCenter&&!1===b.viewport.invert?e.drawImage(d.getImage(),0,0,d.width,d.height,0,0,d.width,d.height):a.renderColorImage(b,c)}a.rendering.webImage=b,a.renderWebImage=b}(cornerstone),function(a){"use strict";function b(b){var c=a.getEnabledElement(b),d=a.internal.getDefaultViewport(c.canvas,c.image);c.viewport=d,a.updateImage(b)}a.reset=b}(cornerstone),function(a){"use strict";function b(a,b){b.width=a.clientWidth,b.height=a.clientHeight,b.style.width=a.clientWidth+"px",b.style.height=a.clientHeight+"px"}function c(c,d){var e=a.getEnabledElement(c);b(c,e.canvas);var f={element:c};$(c).trigger("CornerstoneElementResized",f),void 0!==e.image&&(!0===d?a.fitToWindow(c):a.updateImage(c))}a.resize=c}(cornerstone),function(a){"use strict";function b(b,c,d){if(void 0===b)throw"setToPixelCoordinateSystem: parameter enabledElement must not be undefined";if(void 0===c)throw"setToPixelCoordinateSystem: parameter context must not be undefined";var e=a.internal.calculateTransform(b,d);c.setTransform(e.m[0],e.m[1],e.m[2],e.m[3],e.m[4],e.m[5])}a.setToPixelCoordinateSystem=b}(cornerstone),function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b);d.viewport.scale=c.scale,d.viewport.translation.x=c.translation.x,d.viewport.translation.y=c.translation.y,d.viewport.voi.windowWidth=c.voi.windowWidth,d.viewport.voi.windowCenter=c.voi.windowCenter,d.viewport.invert=c.invert,d.viewport.pixelReplication=c.pixelReplication,d.viewport.rotation=c.rotation,d.viewport.hflip=c.hflip,d.viewport.vflip=c.vflip,d.viewport.modalityLUT=c.modalityLUT,d.viewport.voiLUT=c.voiLUT,d.viewport.voi.windowWidth<1e-6&&(d.viewport.voi.windowWidth=1e-6),d.viewport.scale<1e-4&&(d.viewport.scale=.25),360!==d.viewport.rotation&&-360!==d.viewport.rotation||(d.viewport.rotation=0),a.updateImage(b)}a.setViewport=b}(cornerstone),function(a){"use strict";function b(b,c){var d=a.getEnabledElement(b);if(void 0===d.image)throw"updateImage: image has not been loaded yet";a.drawImage(d,c)}a.updateImage=b}(cornerstone),function(a){"use strict";function b(a,b,c){var d=a.createShader(c);if(a.shaderSource(d,b),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS)&&!a.isContextLost()){var e=a.getShaderInfoLog(d);console.error("Could not compile shader:\n"+e)}return d}function c(a,b,c){var d=a.createProgram();if(a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d),!a.getProgramParameter(d,a.LINK_STATUS)&&!a.isContextLost()){var e=a.getProgramInfoLog(d);console.error("WebGL program filed to link:\n"+e)}return d}function d(a,d,e){return c(a,b(a,d,a.VERTEX_SHADER),b(a,e,a.FRAGMENT_SHADER))}a.webGL||(a.webGL={}),a.webGL.createProgramFromString=d}(cornerstone),function(a){"use strict";function b(){return t}function c(){for(var b in a.webGL.shaders){var c=a.webGL.shaders[b];c.attributes={},c.uniforms={},c.vert=a.webGL.vertexShader,c.program=a.webGL.createProgramFromString(q,c.vert,c.frag),c.attributes.texCoordLocation=q.getAttribLocation(c.program,"a_texCoord"),q.enableVertexAttribArray(c.attributes.texCoordLocation),c.attributes.positionLocation=q.getAttribLocation(c.program,"a_position"),q.enableVertexAttribArray(c.attributes.positionLocation),c.uniforms.resolutionLocation=q.getUniformLocation(c.program,"u_resolution")}}function d(){!0!==a.webGL.isWebGLInitialized&&h(t)&&(m(),c(),a.webGL.isWebGLInitialized=!0)}function e(a,b,c){a.bufferData(a.ARRAY_BUFFER,new Float32Array([b,c,0,c,b,0,0,0]),a.STATIC_DRAW)}function f(a){a.preventDefault(),console.warn("WebGL Context Lost!")}function g(b){b.preventDefault(),a.webGL.isWebGLInitialized=!1,a.webGL.textureCache.purgeCache(),d()}function h(b){q=null;try{var c={preserveDrawingBuffer:!0};!0===a.webGL.debug&&WebGLDebugUtils&&(t=WebGLDebugUtils.makeLostContextSimulatingCanvas(t)),q=b.getContext("webgl",c)||b.getContext("experimental-webgl",c),b.removeEventListener("webglcontextlost",f,!1),b.addEventListener("webglcontextlost",f,!1),b.removeEventListener("webglcontextrestored",g,!1),b.addEventListener("webglcontextrestored",g,!1)}catch(a){throw"Error creating WebGL context"}return q||(console.error("Unable to initialize WebGL. Your browser may not support it."),q=null),q}function i(a){if(a.color)return"rgb";var b="int";return a.minPixelValue>=0&&(b="u"+b),a.maxPixelValue>255?b+="16":b+="8",b}function j(b){var c=i(b);return a.webGL.shaders.hasOwnProperty(c)?a.webGL.shaders[c]:a.webGL.shaders.rgb}function k(b){var c=a.webGL.textureCache.getImageTexture(b.imageId);return c||(c=l(b),a.webGL.textureCache.putImageTexture(b,c)),c.texture}function l(b){var c={uint8:q.LUMINANCE,int8:q.LUMINANCE_ALPHA,uint16:q.LUMINANCE_ALPHA,int16:q.RGB,rgb:q.RGB},d={int8:1,uint16:2,int16:3,rgb:3},e=i(b),f=c[e],g=q.createTexture();q.bindTexture(q.TEXTURE_2D,g),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.pixelStorei(q.UNPACK_ALIGNMENT,1);var h=a.webGL.dataUtilities[e].storedPixelDataToImageData(b,b.width,b.height);return q.texImage2D(q.TEXTURE_2D,0,f,b.width,b.height,0,f,q.UNSIGNED_BYTE,h),{texture:g,sizeInBytes:b.width*b.height*d[e]}}function m(){s=q.createBuffer(),q.bindBuffer(q.ARRAY_BUFFER,s),q.bufferData(q.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),q.STATIC_DRAW),r=q.createBuffer(),q.bindBuffer(q.ARRAY_BUFFER,r),q.bufferData(q.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),q.STATIC_DRAW)}function n(a,b,c,d,f){q.clearColor(1,0,0,1),q.viewport(0,0,d,f),q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT),q.useProgram(a.program),q.bindBuffer(q.ARRAY_BUFFER,r),q.vertexAttribPointer(a.attributes.texCoordLocation,2,q.FLOAT,!1,0,0),q.bindBuffer(q.ARRAY_BUFFER,s),q.vertexAttribPointer(a.attributes.positionLocation,2,q.FLOAT,!1,0,0);for(var g in b){var h=q.getUniformLocation(a.program,g);if(!h)throw"Could not access location for uniform: "+g;var i=b[g],j=i.type,k=i.value;"i"==j?q.uniform1i(h,k):"f"==j?q.uniform1f(h,k):"2f"==j&&q.uniform2f(h,k[0],k[1])}e(q,d,f),q.activeTexture(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,c),q.drawArrays(q.TRIANGLE_STRIP,0,4)}function o(a){var b=a.image;t.width=b.width,t.height=b.height;var c=a.viewport,d=j(b),e=k(b);return n(d,{u_resolution:{type:"2f",value:[b.width,b.height]},wc:{type:"f",value:c.voi.windowCenter},ww:{type:"f",value:c.voi.windowWidth},slope:{type:"f",value:b.slope},intercept:{type:"f",value:b.intercept},invert:{type:"i",value:c.invert?1:0}},e,b.width,b.height),t}function p(){var a={failIfMajorPerformanceCaveat:!0};try{var b=document.createElement("canvas");return!!window.WebGLRenderingContext&&(b.getContext("webgl",a)||b.getContext("experimental-webgl",a))}catch(a){return!1}}a.webGL||(a.webGL={});var q,r,s,t=document.createElement("canvas");a.webGL.isWebGLInitialized=!1,a.webGL.renderer={render:o,initRenderer:d,getRenderCanvas:b,isWebGLAvailable:p}}(cornerstone),function(a){"use strict";function b(a){for(var b=a.getPixelData(),c=new Uint8Array(a.width*a.height*3),d=0,e=0;e<b.length;e++){var f=Math.abs(b[e]);c[d++]=parseInt(255&f,10),c[d++]=parseInt(f>>8,10),c[d++]=b[e]<0?0:1}return c}a.webGL||(a.webGL={}),a.webGL.shaders||(a.webGL.shaders={}),a.webGL.dataUtilities||(a.webGL.dataUtilities={});var c={};a.webGL.dataUtilities.int16={storedPixelDataToImageData:b},c.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",a.webGL.shaders.int16=c}(cornerstone),function(a){"use strict";function b(a){for(var b=a.getPixelData(),c=new Uint8Array(a.width*a.height*2),d=0,e=0;e<b.length;e++)c[d++]=parseInt(b[e],10),c[d++]=b[e]<0?0:1;return c}a.webGL||(a.webGL={}),a.webGL.shaders||(a.webGL.shaders={}),a.webGL.dataUtilities||(a.webGL.dataUtilities={});var c={};a.webGL.dataUtilities.int8={storedPixelDataToImageData:b},c.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",a.webGL.shaders.int8=c}(cornerstone),function(a){"use strict";function b(a){var b=a.minPixelValue,c=0,d=0,e=a.width*a.height*4,f=a.width*a.height*3,g=a.getPixelData(),h=new Uint8Array(f);if(b<0)for(;d<e;)h[c++]=g[d++]+-b,h[c++]=g[d++]+-b,h[c++]=g[d++]+-b,d+=1;else for(;d<e;)h[c++]=g[d++],h[c++]=g[d++],h[c++]=g[d++],d+=1;return h}a.webGL||(a.webGL={}),a.webGL.shaders||(a.webGL.shaders={}),a.webGL.dataUtilities||(a.webGL.dataUtilities={});var c={};a.webGL.dataUtilities.rgb={storedPixelDataToImageData:b},c.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}",a.webGL.shaders.rgb=c}(cornerstone),function(a){"use strict";function b(a){for(var b=a.getPixelData(),c=new Uint8Array(a.width*a.height*2),d=0,e=0;e<b.length;e++){var f=b[e];c[d++]=parseInt(255&f,10),c[d++]=parseInt(f>>8,10)}return c}a.webGL||(a.webGL={}),a.webGL.shaders||(a.webGL.shaders={}),a.webGL.dataUtilities||(a.webGL.dataUtilities={});var c={};a.webGL.dataUtilities.uint16={storedPixelDataToImageData:b},
c.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",a.webGL.shaders.uint16=c}(cornerstone),function(a){"use strict";function b(a){for(var b=a.getPixelData(),c=new Uint8Array(b.length),d=0;d<b.length;d++)c[d]=parseInt(b[d],10);return c}a.webGL||(a.webGL={}),a.webGL.shaders||(a.webGL.shaders={}),a.webGL.dataUtilities||(a.webGL.dataUtilities={});var c={};a.webGL.dataUtilities.uint8={storedPixelDataToImageData:b},c.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}",a.webGL.shaders.uint8=c}(cornerstone),function(a){"use strict";function b(a){if(void 0===a)throw"setMaximumSizeBytes: parameter numBytes must not be undefined";if(void 0===a.toFixed)throw"setMaximumSizeBytes: parameter numBytes must be a number";k=a,c()}function c(){function b(a,b){return a.timeStamp>b.timeStamp?-1:a.timeStamp<b.timeStamp?1:0}if(!(l<=k)){for(j.sort(b);l>k;){var c=j[j.length-1];l-=c.sizeInBytes,delete i[c.imageId],j.pop(),$(a).trigger("CornerstoneWebGLTextureRemoved",{imageId:c.imageId})}var d=a.imageCache.getCacheInfo();console.log("CornerstoneWebGLTextureCacheFull"),$(a).trigger("CornerstoneWebGLTextureCacheFull",d)}}function d(a,b){var d=a.imageId;if(void 0===a)throw"putImageTexture: image must not be undefined";if(void 0===d)throw"putImageTexture: imageId must not be undefined";if(void 0===b)throw"putImageTexture: imageTexture must not be undefined";if(!0===i.hasOwnProperty(d))throw"putImageTexture: imageId already in cache";var e={imageId:d,imageTexture:b,timeStamp:new Date,sizeInBytes:b.sizeInBytes};if(i[d]=e,j.push(e),void 0===b.sizeInBytes)throw"putImageTexture: imageTexture does not have sizeInBytes property or";if(void 0===b.sizeInBytes.toFixed)throw"putImageTexture: imageTexture.sizeInBytes is not a number";l+=e.sizeInBytes,c()}function e(a){if(void 0===a)throw"getImageTexture: imageId must not be undefined";var b=i[a];if(void 0!==b)return b.timeStamp=new Date,b.imageTexture}function f(a){if(void 0===a)throw"removeImageTexture: imageId must not be undefined";var b=i[a];if(void 0===b)throw"removeImageTexture: imageId must not be undefined";return j.splice(j.indexOf(b),1),l-=b.sizeInBytes,delete i[a],b.imageTexture}function g(){return{maximumSizeInBytes:k,cacheSizeInBytes:l,numberOfImagesCached:j.length}}function h(){for(;j.length>0;){var a=j.pop();delete i[a.imageId]}l=0}var i={},j=[],k=268435456,l=0;a.webGL.textureCache={putImageTexture:d,getImageTexture:e,removeImageTexture:f,setMaximumSizeBytes:b,getCacheInfo:g,purgeCache:h,cachedImages:j}}(cornerstone),function(a){"use strict";a.webGL||(a.webGL={}),a.webGL.vertexShader="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}(cornerstone);